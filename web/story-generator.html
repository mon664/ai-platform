<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì¥ë©´ ìƒì„±ê¸° - AI í†µí•© ê´€ë¦¬ í”Œë«í¼</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .story-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .generator-form {
            background: linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: white;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
        }
        .generate-btn {
            background: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }
        .generate-btn:hover {
            background: #45a049;
        }
        .result-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4);
            width: 0%;
            transition: width 0.3s;
        }
        .scenes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .scene-card {
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .scene-card:hover {
            transform: translateY(-5px);
        }
        .scene-image {
            position: relative;
            width: 100%;
            height: 400px;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
        }
        .scene-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .scene-number {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .scene-description {
            padding: 15px;
        }
        .scene-description h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .scene-description p {
            margin: 0;
            color: #666;
            line-height: 1.5;
        }
        .character-upload {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .character-box {
            flex: 1;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            border: 2px dashed rgba(255,255,255,0.3);
        }
        .character-preview {
            width: 100%;
            height: 150px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-top: 10px;
        }
        .character-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .hidden {
            display: none;
        }
        .error-message {
            background: #f44336;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .success-message {
            background: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .download-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        .regenerate-btn {
            background: #FF9800;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <!-- í†µí•© ë„¤ë¹„ê²Œì´ì…˜ ë¡œë“œ -->
    <div id="navigation-container"></div>

    <div class="container">

        <div class="story-container">
            <div class="generator-form">
                <h2 style="color: white; margin-bottom: 20px;">ì¥ë©´ ìƒì„± ì„¤ì •</h2>

                <div id="error-container" class="hidden"></div>
                <div id="success-container" class="hidden"></div>

                <div class="form-group">
                    <label for="storyPrompt">ìŠ¤í† ë¦¬ í”„ë¡¬í”„íŠ¸</label>
                    <textarea id="storyPrompt" rows="4" placeholder="ìƒì„±í•  ìŠ¤í† ë¦¬ì˜ ë‚´ìš©ì„ ìƒì„¸í•˜ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”..."></textarea>
                </div>

                <div class="character-upload">
                    <div class="character-box">
                        <label style="color: white;">ì£¼ì¸ê³µ ìºë¦­í„°</label>
                        <input type="file" id="protagonistImage" accept="image/*" style="color: white;">
                        <div class="character-preview" id="protagonistPreview">
                            <span>ì£¼ì¸ê³µ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</span>
                        </div>
                    </div>
                    <div class="character-box">
                        <label style="color: white;">ìƒëŒ€ì—­ ìºë¦­í„° (ì„ íƒ)</label>
                        <input type="file" id="supportingImage" accept="image/*" style="color: white;">
                        <div class="character-preview" id="supportingPreview">
                            <span>ìƒëŒ€ì—­ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="sceneCount">ì¥ë©´ ìˆ˜</label>
                    <select id="sceneCount">
                        <option value="8">8ê°œ ì¥ë©´</option>
                        <option value="12" selected>12ê°œ ì¥ë©´</option>
                        <option value="16">16ê°œ ì¥ë©´</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="aspectRatio">ì´ë¯¸ì§€ ë¹„ìœ¨</label>
                    <select id="aspectRatio">
                        <option value="16:9" selected>16:9 (ì¼ë°˜ ì˜ìƒ)</option>
                        <option value="9:16">9:16 (ë¦´ìŠ¤/ì‡¼ì¸ )</option>
                        <option value="1:1">1:1 (ì •ì‚¬ê°í˜•)</option>
                        <option value="4:3">4:3 (ì¼ë°˜ ë¹„ìœ¨)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="imageStyle">ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼</label>
                    <select id="imageStyle">
                        <option value="photorealistic" selected>ì‹¤ì‚¬ ì‚¬ì§„</option>
                        <option value="cartoon">ë§Œí™” ìŠ¤íƒ€ì¼</option>
                        <option value="anime">ì• ë‹ˆë©”ì´ì…˜</option>
                        <option value="3d">3D ë Œë”ë§</option>
                        <option value="oil-painting">ìœ í™”</option>
                        <option value="watercolor">ìˆ˜ì±„í™”</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="mood">ë¶„ìœ„ê¸°</label>
                    <select id="mood">
                        <option value="dramatic" selected>ë“œë¼ë§ˆí‹±</option>
                        <option value="romantic">ë¡œë§¨í‹±</option>
                        <option value="comedy">ì½”ë¯¸ë””</option>
                        <option value="thriller">ìŠ¤ë¦´ëŸ¬</option>
                        <option value="fantasy">íŒíƒ€ì§€</option>
                        <option value="documentary">ë‹¤íë©˜í„°ë¦¬</option>
                    </select>
                </div>

                <button class="generate-btn" onclick="generateStory()">
                    ğŸ“– ìŠ¤í† ë¦¬ ì¥ë©´ ìƒì„± ì‹œì‘
                </button>
            </div>

            <div id="loading-container" class="result-container hidden">
                <h3>ìŠ¤í† ë¦¬ ì¥ë©´ ìƒì„± ì¤‘...</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <p id="progress-text">ì´ˆê¸°í™” ì¤‘...</p>
            </div>

            <div id="result-container" class="result-container hidden">
                <h3>âœ… ìŠ¤í† ë¦¬ ì¥ë©´ ìƒì„± ì™„ë£Œ!</h3>
                <button class="download-btn" onclick="downloadAllImages()">ğŸ“¦ ì „ì²´ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</button>

                <div class="scenes-grid" id="scenes-grid"></div>
            </div>
        </div>
    </div>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="script.js"></script>

    <script>
        let generatingStory = false;
        let protagonistImageData = null;
        let supportingImageData = null;

        // ìºë¦­í„° ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
        document.getElementById('protagonistImage').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    protagonistImageData = e.target.result;
                    document.getElementById('protagonistPreview').innerHTML =
                        `<img src="${e.target.result}" alt="ì£¼ì¸ê³µ">`;
                };
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('supportingImage').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    supportingImageData = e.target.result;
                    document.getElementById('supportingPreview').innerHTML =
                        `<img src="${e.target.result}" alt="ìƒëŒ€ì—­">`;
                };
                reader.readAsDataURL(file);
            }
        });

        function showError(message) {
            const container = document.getElementById('error-container');
            container.innerHTML = `<div class="error-message">${message}</div>`;
            container.classList.remove('hidden');
            setTimeout(() => container.classList.add('hidden'), 5000);
        }

        function showSuccess(message) {
            const container = document.getElementById('success-container');
            container.innerHTML = `<div class="success-message">${message}</div>`;
            container.classList.remove('hidden');
            setTimeout(() => container.classList.add('hidden'), 5000);
        }

        function updateProgress(percentage, text) {
            document.getElementById('progress-fill').style.width = percentage + '%';
            document.getElementById('progress-text').textContent = text;
        }

        async function generateStory() {
            if (generatingStory) return;

            const storyPrompt = document.getElementById('storyPrompt').value;
            if (!storyPrompt.trim()) {
                showError('ìŠ¤í† ë¦¬ í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            generatingStory = true;
            const formData = {
                storyPrompt,
                sceneCount: document.getElementById('sceneCount').value,
                aspectRatio: document.getElementById('aspectRatio').value,
                imageStyle: document.getElementById('imageStyle').value,
                mood: document.getElementById('mood').value,
                protagonistImage: protagonistImageData,
                supportingImage: supportingImageData
            };

            // ë¡œë”© í‘œì‹œ
            document.getElementById('loading-container').classList.remove('hidden');
            document.getElementById('result-container').classList.add('hidden');
            document.querySelector('.generate-btn').disabled = true;
            document.querySelector('.generate-btn').textContent = 'â³ ìƒì„± ì¤‘...';

            try {
                updateProgress(10, 'ìŠ¤í† ë¦¬ êµ¬ì¡° ë¶„ì„ ì¤‘...');
                await new Promise(resolve => setTimeout(resolve, 1000));

                updateProgress(20, 'ì¥ë©´ë³„ í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘...');
                await new Promise(resolve => setTimeout(resolve, 2000));

                updateProgress(40, 'ìºë¦­í„° ì¼ê´€ì„± ë¶„ì„ ì¤‘...');
                await new Promise(resolve => setTimeout(resolve, 1000));

                updateProgress(60, 'ì¥ë©´ ì´ë¯¸ì§€ ìƒì„± ì¤‘...');

                // API í˜¸ì¶œ ë˜ëŠ” ë°ëª¨ ë°ì´í„° ìƒì„±
                const result = await generateStoryScenes(formData);

                updateProgress(90, 'ìµœì¢… ê²°ê³¼ ì •ë¦¬ ì¤‘...');
                await new Promise(resolve => setTimeout(resolve, 1000));

                displayStoryResult(result);

                updateProgress(100, 'âœ… ìŠ¤í† ë¦¬ ì¥ë©´ ìƒì„± ì™„ë£Œ!');
                showSuccess('ìŠ¤í† ë¦¬ ì¥ë©´ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');

            } catch (error) {
                showError('ìŠ¤í† ë¦¬ ìƒì„± ì‹¤íŒ¨: ' + error.message);
            } finally {
                generatingStory = false;
                document.querySelector('.generate-btn').disabled = false;
                document.querySelector('.generate-btn').textContent = 'ğŸ“– ìŠ¤í† ë¦¬ ì¥ë©´ ìƒì„± ì‹œì‘';

                setTimeout(() => {
                    document.getElementById('loading-container').classList.add('hidden');
                }, 2000);
            }
        }

        async function generateStoryScenes(formData) {
            const scenes = [];
            const sceneCount = parseInt(formData.sceneCount);

            // ë°ëª¨ ìŠ¤í† ë¦¬ ì¥ë©´ ìƒì„±
            const storyStructure = generateStoryStructure(formData.storyPrompt, sceneCount);

            for (let i = 0; i < sceneCount; i++) {
                const scene = {
                    number: i + 1,
                    title: storyStructure[i].title,
                    description: storyStructure[i].description,
                    imageUrl: `https://picsum.photos/seed/story_${Date.now()}_${i}/400/600.jpg`,
                    prompt: `${formData.storyPrompt} - ì¥ë©´ ${i + 1}: ${storyStructure[i].title}, ${formData.imageStyle} ìŠ¤íƒ€ì¼, ${formData.mood} ë¶„ìœ„ê¸°`
                };
                scenes.push(scene);

                // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
                updateProgress(60 + (i / sceneCount) * 25, `ì¥ë©´ ${i + 1}/${sceneCount} ìƒì„± ì¤‘...`);
                await new Promise(resolve => setTimeout(resolve, 500));
            }

            return scenes;
        }

        function generateStoryStructure(prompt, sceneCount) {
            // ê¸°ë³¸ ìŠ¤í† ë¦¬ êµ¬ì¡° ìƒì„±
            const structures = {
                8: [
                    { title: 'ë„ì…', description: 'ì´ì•¼ê¸°ì˜ ì‹œì‘, ì£¼ì¸ê³µ ì†Œê°œ' },
                    { title: 'ë¬¸ì œ ì œì‹œ', description: 'ì£¼ì¸ê³µì´ ë§ˆì£¼í•œ ë¬¸ì œ' },
                    { title: 'ê°ˆë“± ì‹¬í™”', description: 'ë¬¸ì œê°€ ë” ë³µì¡í•´ì§' },
                    { title: 'ì „í™˜ì ', description: 'ìƒí™©ì´ ë°”ë€ŒëŠ” ì¤‘ìš”í•œ ìˆœê°„' },
                    { title: 'ê³ ë‚œ', description: 'ê°€ì¥ í˜ë“  ì‹œë ¨' },
                    { title: 'í•´ê²°ì˜ ì‹¤ë§ˆë¦¬', description: 'ë¬¸ì œ í•´ê²°ì˜ ë‹¨ì„œ' },
                    { title: 'í´ë¼ì´ë§¥ìŠ¤', description: 'ì´ì•¼ê¸°ì˜ ì ˆì •' },
                    { title: 'ê²°ë§', description: 'ì´ì•¼ê¸°ì˜ ë§ˆë¬´ë¦¬' }
                ],
                12: [
                    { title: 'í‰ì˜¨í•œ ì¼ìƒ', description: 'ì´ì•¼ê¸° ì‹œì‘ ì „ì˜ í‰í™”ë¡œìš´ ëª¨ìŠµ' },
                    { title: 'ì‚¬ê±´ ë°œìƒ', description: 'ì´ì•¼ê¸°ë¥¼ ì›€ì§ì´ëŠ” ì²« ë²ˆì§¸ ì‚¬ê±´' },
                    { title: 'í˜¸ê¸°ì‹¬', description: 'ì£¼ì¸ê³µì˜ ê´€ì‹¬ê³¼ íƒêµ¬ ì‹œì‘' },
                    { title: 'ì²« ë²ˆì§¸ ì¥ì• ë¬¼', description: 'ì£¼ì¸ê³µì´ ë§ë‹¥ëœ¨ë¦° ì²« ë²ˆì§¸ ì–´ë ¤ì›€' },
                    { title: 'ì¡°ë ¥ì ë“±ì¥', description: 'ë„ì›€ì„ ì£¼ëŠ” ì¸ë¬¼ì˜ ë“±ì¥' },
                    { title: 'ìƒˆë¡œìš´ ë°œê²¬', description: 'ì¤‘ìš”í•œ ì •ë³´ë‚˜ ë‹¨ì„œ ë°œê²¬' },
                    { title: 'ë°°ì‹ ì´ë‚˜ ìœ„ê¸°', description: 'ì˜ˆìƒì¹˜ ëª»í•œ ìœ„ê¸° ìƒí™©' },
                    { title: 'í¬ë§ì˜ ë¹›', description: 'ì–´ë‘ìš´ ìƒí™© ì† í¬ë§ ë°œê²¬' },
                    { title: 'ë§ˆì§€ë§‰ ì¤€ë¹„', description: 'ê²°ì „ì„ ìœ„í•œ ì¤€ë¹„' },
                    { title: 'í´ë¼ì´ë§¥ìŠ¤', description: 'ì´ì•¼ê¸°ì˜ ê°€ì¥ ì ˆì •ëœ ìˆœê°„' },
                    { title: 'ê²°ê³¼', description: 'í´ë¼ì´ë§¥ìŠ¤ì˜ ê²°ê³¼' },
                    { title: 'ìƒˆë¡œìš´ ì‹œì‘', description: 'ë³€í™”ëœ ì‚¶ì˜ ì‹œì‘' }
                ],
                16: [
                    { title: 'ì„œì¥: í‰í™”', description: 'ëª¨ë“  ê²ƒì´ í‰í™”ë¡œìš´ ì‹œì‘' },
                    { title: 'ì „ì¡°', description: 'ë³€í™”ê°€ ì˜¬ ê²ƒì„ ì•”ì‹œ' },
                    { title: 'ì²« ë²ˆì§¸ ê· ì—´', description: 'í‰ì˜¨ì´ ê¹¨ì§€ê¸° ì‹œì‘' },
                    { title: 'ì‘ì€ ì‚¬ê±´', description: 'í¬ì§€ ì•Šì€ ì¤‘ìš”í•œ ì‚¬ê±´' },
                    { title: 'í˜¸ê¸°ì‹¬ ë°œë™', description: 'ì£¼ì¸ê³µì˜ ì ê·¹ì ì¸ íƒìƒ‰ ì‹œì‘' },
                    { title: 'ì²« ë²ˆì§¸ ë‹¨ì„œ', description: 'ë¬¸ì œ í•´ê²°ì˜ ì²« ë‹¨ì„œ' },
                    { title: 'ë¯¸ê¶', description: 'ë” ë³µì¡í•´ì§„ ìƒí™©' },
                    { title: 'ë™ë§¹', description: 'í•¨ê»˜í•˜ëŠ” ì‚¬ëŒë“¤ì˜ ë“±ì¥' },
                    { title: 'ì²« ë²ˆì§¸ ì‹¤íŒ¨', description: 'ì²« ë²ˆì§¸ ì‹œë„ì˜ ì‹¤íŒ¨' },
                    { title: 'ì¬ê¸°', description: 'ì‹¤íŒ¨ í›„ ë‹¤ì‹œ ì¼ì–´ì„œëŠ” ëª¨ìŠµ' },
                    { title: 'í•µì‹¬ ì§„ì‹¤', description: 'ê°€ì¥ ì¤‘ìš”í•œ ì‚¬ì‹¤ ë°œê²¬' },
                    { title: 'ìµœí›„ì˜ ì„ íƒ', description: 'ê°€ì¥ ì¤‘ìš”í•œ ì„ íƒì˜ ìˆœê°„' },
                    { title: 'ëŒ€ê²°', description: 'ìµœì¢…ì ì¸ ëŒ€ê²°ì´ë‚˜ ëŒ€ë©´' },
                    { title: 'í¬ìƒ', description: 'ë¬´ì–¸ê°€ë¥¼ í¬ê¸°í•˜ëŠ” ìˆœê°„' },
                    { title: 'ìŠ¹ë¦¬', description: 'ëª©í‘œ ë‹¬ì„±ì˜ ìˆœê°„' },
                    { title: 'ìƒˆë¡œìš´ ì—¬ì •', description: 'ëì´ì ìƒˆë¡œìš´ ì‹œì‘' }
                ]
            };

            return structures[sceneCount] || structures[12];
        }

        function displayStoryResult(scenes) {
            const scenesGrid = document.getElementById('scenes-grid');
            scenesGrid.innerHTML = '';

            scenes.forEach(scene => {
                const sceneCard = document.createElement('div');
                sceneCard.className = 'scene-card';
                sceneCard.innerHTML = `
                    <div class="scene-image">
                        <div class="scene-number">ì¥ë©´ ${scene.number}</div>
                        <img src="${scene.imageUrl}" alt="${scene.title}" loading="lazy">
                    </div>
                    <div class="scene-description">
                        <h4>${scene.title}</h4>
                        <p>${scene.description}</p>
                        <button class="regenerate-btn" onclick="regenerateScene(${scene.number - 1})">
                            ğŸ”„ ì¥ë©´ ì¬ìƒì„±
                        </button>
                    </div>
                `;
                scenesGrid.appendChild(sceneCard);
            });

            document.getElementById('result-container').classList.remove('hidden');
        }

        function regenerateScene(sceneIndex) {
            showSuccess(`${sceneIndex + 1}ë²ˆ ì¥ë©´ì„ ì¬ìƒì„±í•©ë‹ˆë‹¤...`);
            // ì—¬ê¸°ì— ì¥ë©´ ì¬ìƒì„± API í˜¸ì¶œ ë¡œì§ ì¶”ê°€
        }

        function downloadAllImages() {
            showSuccess('ì „ì²´ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...');
            // ì—¬ê¸°ì— ì „ì²´ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë¡œì§ ì¶”ê°€
        }
    </script>
    <script src="script.js"></script>
</body>
</html>