<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API í”„ë¡ì‹œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
    </style>
</head>
<body>
    <h1>ğŸ”§ API í”„ë¡ì‹œ í…ŒìŠ¤íŠ¸</h1>

    <button onclick="testLocalAPI()">ë¡œì»¬ API í…ŒìŠ¤íŠ¸</button>
    <button onclick="testDirectAPI()">ì§ì ‘ API í…ŒìŠ¤íŠ¸</button>
    <button onclick="testCORSProxy()">CORS í”„ë¡ì‹œ í…ŒìŠ¤íŠ¸</button>

    <div id="results"></div>

    <script>
        async function testLocalAPI() {
            try {
                const response = await fetch('/api/generate-shorts', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        keywords: 'í…ŒìŠ¤íŠ¸',
                        script: 'í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸',
                        sceneCount: 3
                    })
                });

                const result = await response.text();
                addResult('Local API', result, response.ok);
            } catch (error) {
                addResult('Local API', error.message, false);
            }
        }

        async function testDirectAPI() {
            try {
                // CORS ìš°íšŒë¥¼ ìœ„í•œ ê³µê°œ í”„ë¡ì‹œ ì‚¬ìš©
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const targetUrl = 'https://ai-platform-git-master-ggs-projects-fd033eb3.vercel.app/api/generate-shorts';

                const response = await fetch(proxyUrl + targetUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    body: JSON.stringify({
                        keywords: 'í…ŒìŠ¤íŠ¸',
                        script: 'í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸',
                        sceneCount: 3
                    })
                });

                const result = await response.text();
                addResult('Direct API', result, response.ok);
            } catch (error) {
                addResult('Direct API', error.message, false);
            }
        }

        async function testCORSProxy() {
            try {
                // ë‹¤ë¥¸ CORS í”„ë¡ì‹œ í…ŒìŠ¤íŠ¸
                const response = await fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent('https://ai-platform-git-master-ggs-projects-fd033eb3.vercel.app/api/generate-shorts'));

                const result = await response.text();
                addResult('CORS Proxy', result, response.ok);
            } catch (error) {
                addResult('CORS Proxy', error.message, false);
            }
        }

        function addResult(title, content, success) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${success ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${title}:</strong><br>${content}`;
            results.appendChild(div);
        }
    </script>
</body>
</html>