# AI Content Platform - 프로젝트 현황 (최종 업데이트: 2025-11-01)

## 📌 프로젝트 정보

**프로젝트명:** AI Content Platform
**배포 URL:** https://ai-platform-one.vercel.app
**GitHub:** https://github.com/mon664/ai-platform
**배포 플랫폼:** Vercel (자동 배포)
**프레임워크:** Next.js 15.5.2 (App Router) + React 19 + TypeScript

---

## 🎯 전체 기능 현황

| 기능 | 경로 | 상태 | 설명 |
|------|------|------|------|
| **홈페이지** | / | ✅ 정상 | 전체 기능 소개 페이지 |
| **쇼츠 생성기** | /shorts | ✅ 정상 | 대본, 이미지, 음성 생성 + 개별 재생성 |
| **장면 생성기** | /story | ✅ 정상 | 얼굴 일관성 유지, 8/12/16 장면 생성 |
| **캐릭터 생성기** | /character | ✅ 정상 | 단일 캐릭터 이미지 생성 |
| **음성 생성기** | /tts | ⚠️ API 권한 문제 | 2명 화자 지원, SSML (TTS API 권한 필요) |
| **개발 블로그** | /blog | ✅ 정상 | 글쓰기/수정/삭제, Redis 스토리지 |

---

## 🔑 API 키 및 환경 변수

### Vercel 환경 변수 설정 위치
- Vercel 대시보드 → ai-platform → Settings → Environment variables
- Production, Preview, Development 모두 동일하게 설정

### 필수 환경 변수

```bash
# Gemini AI (스토리, 쇼츠, 이미지 생성)
GEMINI_API_KEY=AIzaSy... (메인 키)

# Google Cloud API 통합 (TTS, 기타 Google 서비스)
Cloud_all_API=AIzaSyCDznEqbR15saENX8cK1MOLBT-f9wgUxfQ

# Redis 데이터베이스 (블로그 스토리지)
REDIS_URL=redis://default:***@redis-11417.c340.ap-northeast-2-1.ec2.redns.redis-cloud.com:11417
```

### 백업 API 키 (필요시 사용)
```bash
Google_Drive_upload_api=AIzaSyCZ6HakMiNcb-1aaVBP8h_5cxxqlD_s-Io
tts_api=AIzaSyApnOh5AN3HUCeQOHphtt5H6lWQoj_j0U4
google_TTS_api=AIzaSyBkfg2oCL1fJnNF0mvpHGV0U5HnYOPJSKs
All_cloud_api=AIzaSyClh5b0sZSUv8HUkafLFQBxHdYxikfAg40
korean_sound_api=AIzaSyD0SMPBfztN-Lq9mq7lkM-KAGi0b5bOT-Q
aii_gemini_key=AIzaSyDy4vc9b52CYHvtgq4ww9RIDtjK4QV8YdI
```

---

## 🛠️ 기술 스택

### Frontend
- Next.js 15.5.2 (App Router)
- React 19
- TypeScript
- Tailwind CSS
- react-quill-new (React 19 호환 에디터)

### Backend/API
- Next.js API Routes (서버리스 함수)
- Redis (ioredis) - 블로그 데이터베이스
- Vercel 배포 플랫폼

### AI/API 서비스
- Gemini 2.0 Flash Exp - 텍스트 생성 (스토리, 대본)
- Gemini 2.5 Flash Image - 이미지 생성
- Google Cloud Text-to-Speech API - 음성 생성
- Nano Banana API - 캐릭터 이미지 생성

---

## 📱 각 페이지 기능 상세

### 1. 쇼츠 생성기 (/shorts)

**파일 위치:**
- Frontend: `app/shorts/page.tsx`
- API: `app/api/shorts/route.ts`, `app/api/shorts/regenerate/route.ts`

**주요 기능:**
- ✅ 키워드/프롬프트 모드 선택
- ✅ AI 자동 대본 생성 (Gemini 2.0 Flash Exp)
- ✅ 장면별 이미지 생성 (Gemini 2.5 Flash Image)
  - 5가지 스타일: 실사, 애니메이션, 3D 렌더, 판타지 아트, 영화처럼
  - 주인공 사진 업로드 시 얼굴 일관성 유지
- ✅ 개별 이미지 재생성 버튼 (마우스 호버 시 표시)
- ✅ 이미지 생성 실패 시 상세 에러 표시
- ✅ 자막 편집기 (텍스트, 크기, 색상, 폰트)
- ✅ 음성 생성 (Google Cloud TTS)
  - 10+ 음성 선택 가능
  - 속도/피치 조절
  - 톤/분위기 입력 (SSML)
- ✅ 개별 다운로드 버튼
  - 📝 대본 다운로드 (.txt)
  - 🎵 음성 다운로드 (.wav)

**설정 옵션:**
- 영상 길이: 30초/45초/60초
- 장면 수: 3~8개
- 이미지 비율: 9:16 (쇼츠용)

---

### 2. 장면 생성기 (/story)

**파일 위치:**
- Frontend: `app/story/page.tsx`
- API: `app/api/generate/route.ts`

**주요 기능:**
- ✅ 캐릭터 업로드 (주인공 + 상대역)
- ✅ 스토리 직접 작성 (최대 1,000자)
- ✅ 장면 수 선택: 8/12/16 장면
- ✅ 사진 비율 선택
  - 16:9 (YouTube)
  - 9:16 (릴스/쇼츠)
  - 1:1 (Instagram)
  - 4:3, 3:4
- ✅ 얼굴 일관성 유지 기능
- ✅ 장면별 이미지 생성

---

### 3. 캐릭터 생성기 (/character)

**파일 위치:**
- Frontend: `app/character/page.tsx`
- API: `app/api/character/route.ts`

**주요 기능:**
- ✅ 텍스트 프롬프트로 캐릭터 생성
- ✅ Nano Banana API 사용
- ✅ 5가지 비율 선택 (1:1, 16:9, 9:16, 4:3, 3:4)
- ✅ 고품질 캐릭터 이미지 출력
- ✅ 이미지 다운로드 기능

**용도:** YouTube 썸네일, 스토리 주인공용

---

### 4. 음성 생성기 (/tts)

**파일 위치:**
- Frontend: `app/tts/page.tsx`
- API: `app/api/tts/generate/route.ts`

**주요 기능:**
- ✅ 2명 화자 지원 (대화형 콘텐츠)
- ✅ 10+ 음성 선택 (Neural2, Wavenet)
- ✅ 속도/피치 조절
- ✅ SSML 고급 설정
- ✅ WAV 파일 다운로드

**현재 문제:** ⚠️ Google Cloud TTS API 권한 오류 (아래 참고)

---

### 5. 개발 블로그 (/blog)

**파일 위치:**
- Frontend: `app/blog/page.tsx`, `app/blog/write/page.tsx`, `app/blog/[slug]/page.tsx`, `app/blog/[slug]/edit/page.tsx`
- API: `app/api/blog/create/route.ts`, `app/api/blog/[slug]/route.ts`, `app/api/blog/list/route.ts`
- Storage: `lib/blog-storage.ts`

**주요 기능:**
- ✅ 글쓰기/수정/삭제
- ✅ react-quill-new 에디터 (React 19 호환)
- ✅ 이미지 업로드 기능
- ✅ 임시저장 기능
- ✅ Redis 스토리지 (ioredis)
- ✅ Markdown 기반 렌더링

**데이터 구조:**
- Redis Key: `blog:{slug}` (JSON 문자열)
- Redis List: `blog:list` (모든 slug 목록)

---

## ⚠️ 현재 미해결 문제

### Google Cloud TTS API 권한 오류

**문제:**
```
403 PERMISSION_DENIED - API_KEY_SERVICE_BLOCKED
```

**원인:** API 키가 Text-to-Speech API 사용 권한이 없거나 차단됨

**해결 방법:**
1. Google Cloud Console 접속: https://console.cloud.google.com
2. 프로젝트 `570780883542` 선택 (또는 현재 프로젝트 확인)
3. 'API 및 서비스' > '사용 설정된 API 및 서비스'
4. 'Cloud Text-to-Speech API' 활성화 확인
5. 'API 및 서비스' > '사용자 인증 정보'
6. 사용 중인 API 키 클릭
7. 'API 제한사항'에서 'Cloud Text-to-Speech API' 허용 확인
8. 결제 계정 활성화 상태 확인

**영향:** TTS 기능 사용 불가 (브라우저 TTS는 작동하나 WAV 저장 불가)

---

## 🚀 배포 방법

### 자동 배포 (권장)
1. 코드 수정 후 GitHub에 푸시
```bash
git add .
git commit -m "메시지"
git push
```
2. Vercel이 자동으로 빌드 및 배포 (약 30-60초 소요)

### 수동 배포
```bash
vercel --prod
```

### 배포 확인
```bash
vercel ls                                    # 배포 목록
vercel inspect [URL] --logs                   # 배포 로그 확인
```

---

## 📂 프로젝트 구조

```
ai-platform/
├── app/
│   ├── page.tsx                    # 홈페이지
│   ├── shorts/page.tsx             # 쇼츠 생성기
│   ├── story/page.tsx              # 장면 생성기
│   ├── character/page.tsx          # 캐릭터 생성기
│   ├── tts/page.tsx                # 음성 생성기
│   ├── blog/                       # 블로그 페이지
│   │   ├── page.tsx                # 블로그 목록
│   │   ├── write/page.tsx          # 글쓰기
│   │   ├── [slug]/page.tsx         # 글 상세
│   │   └── [slug]/edit/page.tsx    # 글 수정
│   ├── api/                        # API 라우트
│   │   ├── shorts/
│   │   │   ├── route.ts            # 쇼츠 생성
│   │   │   ├── improve/route.ts    # 프롬프트 개선
│   │   │   └── regenerate/route.ts # 이미지 재생성
│   │   ├── blog/
│   │   │   ├── create/route.ts     # 블로그 생성
│   │   │   ├── [slug]/route.ts     # 블로그 조회/수정/삭제
│   │   │   └── list/route.ts       # 블로그 목록
│   │   ├── tts/
│   │   │   ├── generate/route.ts   # 음성 생성
│   │   │   └── improve/route.ts    # SSML 생성
│   │   ├── character/route.ts      # 캐릭터 생성
│   │   └── generate/route.ts       # 장면 생성
│   ├── components/
│   │   └── Navigation.tsx          # 네비게이션 바
│   └── layout.tsx                  # 레이아웃
├── lib/
│   └── blog-storage.ts             # Redis 블로그 스토리지
├── public/                         # 정적 파일
├── .npmrc                          # npm 설정
├── package.json                    # 의존성 관리
├── tsconfig.json                   # TypeScript 설정
└── tailwind.config.ts              # Tailwind CSS 설정
```

---

## 🔧 로컬 개발 환경 설정

### 1. 저장소 클론
```bash
git clone https://github.com/mon664/ai-platform.git
cd ai-platform
```

### 2. 의존성 설치
```bash
npm install
```

### 3. 환경 변수 설정
`.env.local` 파일 생성:
```bash
GEMINI_API_KEY=your_gemini_key
Cloud_all_API=your_google_cloud_key
REDIS_URL=your_redis_url
```

### 4. 개발 서버 실행
```bash
npm run dev
```
→ http://localhost:3000

### 5. 빌드 테스트
```bash
npm run build
npm start
```

---

## 💡 다음 개발 아이디어

### 우선순위 높음
1. ❗ **TTS API 권한 문제 해결** (최우선)
2. ➕ **음성 쇼츠 완성 기능** (FFmpeg.wasm)
   - 이미지 + 음성 + 대본을 MP4로 자동 합성
   - 예상 소요: 2-3일
3. ➕ **자막 생성 기능** (.srt 파일)
   - 대본 기반 자동 타임스탬프 생성
   - 예상 소요: 0.5일

### 중기 목표
4. ➕ **배경음악 추가 기능**
   - 로열티 프리 음악 라이브러리 연동
   - 예상 소요: 0.5일
5. ➕ **트렌드 키워드 추천**
   - YouTube Data API 연동
   - 예상 소요: 1-2일
6. ➕ **템플릿 시스템**
   - 인기 쇼츠 스타일 템플릿 제공
   - 예상 소요: 0.5일

### 장기 목표
7. ➕ **AI 썸네일 생성기**
   - 텍스트 오버레이 자동 생성
   - 예상 소요: 2일
8. ➕ **YouTube 직접 업로드**
   - YouTube Data API OAuth 2.0
   - 예상 소요: 3-4일
9. ➕ **다국어 쇼츠 자동 번역**
   - Google Translate API + 다국어 TTS
   - 예상 소요: 3-4일
10. ➕ **대시보드 & 분석**
    - 생성 히스토리, 통계, 성과 추적
    - 예상 소요: 3-5일

---

## 📞 트러블슈팅

### 문제: 이미지 생성 실패
**원인:** Gemini API 레이트 리밋 또는 프롬프트 문제
**해결:** 개별 "이미지 재생성" 버튼 사용

### 문제: 음성 생성 403 오류
**원인:** Google Cloud TTS API 권한 문제
**해결:** 위 '미해결 문제' 섹션 참고

### 문제: 배포 실패
**원인:** 환경 변수 미설정
**해결:** Vercel 대시보드에서 환경 변수 확인

### 문제: Redis 연결 오류
**원인:** REDIS_URL 환경 변수 누락
**해결:** Vercel에서 Redis 데이터베이스 생성 및 연결

---

## 📝 개발 가이드

### 새 기능 추가 시 체크리스트
- [ ] 로컬에서 기능 개발 및 테스트
- [ ] TypeScript 타입 정의 추가
- [ ] 에러 핸들링 구현
- [ ] API 엔드포인트 작성 (`app/api/`)
- [ ] 프론트엔드 UI 작성 (`app/`)
- [ ] 환경 변수 필요 시 Vercel에 추가
- [ ] Git 커밋 및 푸시
- [ ] Vercel 자동 배포 확인
- [ ] 프로덕션 환경에서 테스트
- [ ] 프로젝트_진행상황.md 업데이트

### API 추가 시 주의사항
1. Next.js API Route는 서버리스 함수로 실행됨
2. 환경 변수는 `process.env.VARIABLE_NAME`으로 접근
3. 긴 작업은 Vercel 서버리스 함수 타임아웃(10초) 고려
4. 파일 시스템 쓰기 불가 (Redis/DB 사용)

### 코드 스타일
- TypeScript strict 모드 사용
- Tailwind CSS 유틸리티 클래스 사용
- 컴포넌트는 함수형 컴포넌트로 작성
- 비동기 작업은 async/await 사용

---

## 🔒 보안 주의사항

### API 키 관리
- ✅ 모든 API 키는 환경 변수로 관리
- ❌ 절대 코드에 하드코딩하지 말것
- ❌ GitHub에 API 키 커밋 금지
- ✅ `.env.local`은 `.gitignore`에 추가됨

### 데이터베이스
- Redis는 Vercel 통합으로 자동 관리됨
- 블로그 데이터는 Redis에 JSON 형태로 저장

---

## 📊 현재 성능 지표

- **빌드 시간:** 약 20-30초
- **배포 시간:** 약 30-60초 (자동 배포)
- **First Load JS:** 약 102-115 kB
- **API 응답 시간:**
  - 대본 생성: 5-10초
  - 이미지 생성: 3-5초/장면
  - 음성 생성: 5-15초

---

## ✅ 최근 업데이트 (2025-11-01)

### 쇼츠 생성기 개선
- ✅ 이미지 생성 에러 추적 및 상세 표시
- ✅ 성공/실패 개수 UI 표시
- ✅ 실패한 이미지 목록 및 원인 표시
- ✅ 개별 다운로드 버튼 분리 확인 (대본/음성)
- ✅ 개별 이미지 재생성 기능 확인

### 배포 정보
- **커밋:** `4aebd13`
- **배포 URL:** https://ai-platform-one.vercel.app
- **상태:** ✅ 정상 작동

---

**마지막 업데이트:** 2025-11-01
**작업자:** Claude Code AI Assistant
**프로젝트 상태:** ✅ 안정적으로 운영 중 (TTS API 권한 제외)
